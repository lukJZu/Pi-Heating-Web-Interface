(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],[,,,function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},,function(e,t,n){e.exports=n(12)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(1),c=n.n(r),l=(n(10),n(3)),s=n.n(l),i=(n(11),n(4)),u=window.location.host;function m(e,t,n,a){var o;a&&(o=JSON.stringify(a));var r=new XMLHttpRequest,c="".concat(u,"/api/currentStates/").concat(t);r.responseType="json";var l=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var o=n[a].trim();if(o.substring(0,e.length+1)===e+"="){t=decodeURIComponent(o.substring(e.length+1));break}}return t}("csrftoken");r.open(e,c),r.setRequestHeader("Content-Type","application/json"),l&&(r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("X-CSRFToken",l)),r.onload=function(){n(r.response,r.status)},r.onerror=function(e){console.log(e),n({message:"The current states request was an error"},400)},r.send(o)}function d(e){var t=e.boilerState,n=new Date(t.start_time),a=new Date(t.end_time),r=a.getTime()-n.getTime();r=(r=r/1e3/60).toFixed(0);var c={day:"numeric",month:"short"},l={hour:"numeric",minute:"numeric"};return o.a.createElement("tr",null,o.a.createElement("td",null,n.toLocaleDateString("en-gb",c)," ",n.toLocaleTimeString("en-gb",l)),o.a.createElement("td",null,a.toLocaleDateString("en-gb",c)," ",a.toLocaleTimeString("en-gb",l)),o.a.createElement("td",null,r),o.a.createElement("td",null,t.hot_water_state?"ON":"OFF"),o.a.createElement("td",null,t.heating_state?"ON":"OFF"))}function p(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),r=n[0],c=n[1],l=e.limit;return Object(a.useEffect)((function(){!function(e,t){t=t||0;var n=new XMLHttpRequest,a="".concat(u,"/api/boilerStates/").concat(t);n.responseType="json",n.open("GET",a),n.setRequestHeader("X-REQUESTED-WITH","XMLHttpRequest"),n.onload=function(){e(n.response,n.status)},n.onerror=function(t){console.log(t),e({message:"The boiler history request was an error"},400)},n.send()}((function(e,t){200===t?c(e):alert("There was an error");var n=document.getElementById("history-table-spinner");n&&(n.innerHTML="")}),l)}),[]),r.map((function(e,t){return o.a.createElement(d,{boilerState:e,key:"".concat(t)})}))}u.startsWith("http")||(u="http://".concat(u));var h=function(){return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header"},o.a.createElement("img",{src:s.a,className:"App-logo",alt:"logo"}),o.a.createElement("p",null,"Edit ",o.a.createElement("code",null,"src/App.js")," and save to reload."),o.a.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"},"Learn React"),o.a.createElement("div",null,o.a.createElement(p,null))))};function g(e){var t,n=e.controlState,a=e.operationState,r=e.boostState,c=e.cat;t=r||a?"danger":n?"warning":"success";var l,s="heating"===c?"Heating":"Water";l=r?"Boost\nOn":n?"hotWater"===c?"Scheduled\nControl":"Thermostat\nControl":"Control\nOff";return o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-block btn-".concat(t),style:{maxWidth:130,whiteSpace:"pre-wrap"},onClick:function(e){e.preventDefault(),e.target.blur();m("POST","change",(function(e,t){201===t?m("GET","",E,{}):alert("State change failed")}),{device:c,state:!n})}},o.a.createElement("h4",{class:"font-weight-bold alert-heading text-center pt-1"},s),o.a.createElement("hr",{className:"alert-".concat(t)}),o.a.createElement("h6",{className:"text-center"},l),o.a.createElement("hr",{className:"alert-".concat(t)}),o.a.createElement(f,{state:a,type:0})))}function f(e){var t=e.state?"ON":"OFF",n=1===e.type?"h3":"h4";return o.a.createElement(n,{className:"font-weight-bold text-center"},t)}function E(e,t){!function(e){var t=e?"danger":"success";document.getElementById("boiler-operation-block").className="alert alert-".concat(t),c.a.render(o.a.createElement(f,{state:e,type:1}),document.getElementById("boiler-on-off-text"))}(e.operation[2]),c.a.render(o.a.createElement(g,{controlState:e.control.hotWater.state,operationState:e.operation[0],boostState:e.control.hotWater.boost,cat:"hotWater"}),document.getElementById("hotWater-states-block")),c.a.render(o.a.createElement(g,{controlState:e.control.heating.state,operationState:e.operation[1],boostState:!1,cat:"heating"}),document.getElementById("heating-states-block"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var b=document.getElementById("root");b&&c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(h,null)),b);var v=document.getElementById("boilerStateRows");v&&c.a.render(o.a.createElement(p,{limit:0}),v);var S=document.getElementById("boilerStateCard");S&&c.a.render(o.a.createElement(p,{limit:5}),S),m("GET","",E,{}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[5,1,2]]]);
//# sourceMappingURL=main.afc8a222.chunk.js.map