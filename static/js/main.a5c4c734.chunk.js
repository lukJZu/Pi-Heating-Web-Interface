(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],[,,,,function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},function(e,t,a){e.exports=a(12)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(1),c=a.n(o),l=(a(10),a(4)),i=a.n(l),s=(a(11),a(2)),m=window.location.host;function u(e,t,a,n){var r;n&&(r=JSON.stringify(n));var o=new XMLHttpRequest,c="".concat(m,"/api/").concat(t);o.responseType="json";var l=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var r=a[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");o.open(e,c),o.setRequestHeader("Content-Type","application/json"),l&&(o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-CSRFToken",l)),o.onload=function(){a(o.response,o.status)},o.onerror=function(e){console.log(e),a({message:"The current states request was an error"},400)},o.send(r)}function d(e){var t=e.boilerState,a=new Date(t.start_time),n=new Date(t.end_time),o=n.getTime()-a.getTime();o=(o=o/1e3/60).toFixed(0);var c={day:"numeric",month:"short"},l={hour:"numeric",minute:"numeric"};return r.a.createElement("tr",null,r.a.createElement("td",null,a.toLocaleDateString("en-gb",c)," ",a.toLocaleTimeString("en-gb",l)),r.a.createElement("td",null,n.toLocaleDateString("en-gb",c)," ",n.toLocaleTimeString("en-gb",l)),r.a.createElement("td",null,o),r.a.createElement("td",null,t.hot_water_state?"ON":"OFF"),r.a.createElement("td",null,t.heating_state?"ON":"OFF"))}function g(e){var t=Object(n.useState)([]),a=Object(s.a)(t,2),o=a[0],c=a[1],l=e.limit;return Object(n.useEffect)((function(){u("GET","boilerStates/".concat(l),(function(e,t){200===t?c(e):alert("There was an error");var a=document.getElementById("history-table-spinner");a&&(a.innerHTML="")}),l)}),[]),o.map((function(e,t){return r.a.createElement(d,{boilerState:e,key:"".concat(t)})}))}m.startsWith("http")||(m="http://".concat(m));var h=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:i.a,className:"App-logo",alt:"logo"}),r.a.createElement("p",null,"Edit ",r.a.createElement("code",null,"src/App.js")," and save to reload."),r.a.createElement("a",{className:"App-link",href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer"},"Learn React"),r.a.createElement("div",null,r.a.createElement(g,null))))};function f(e){var t,a,n=e.agileRate,o=e.todaysMin,c=e.tmrsMin,l=new Date(n.valid_from),i=new Date(n.valid_to),s=n.rate,m=new Date,u={weekday:"short",day:"numeric",month:"short"},d={hour:"numeric",minute:"numeric"};return o.indexOf(n.valid_from)>-1?t="info":c.indexOf(n.valid_from)>-1?t="primary":s>15?t="danger":s<0?t="success":m>i?t="secondary":m<i&&m>l&&(t="light",a="font-weight-bold"),r.a.createElement("tr",{className:"table-".concat(t)},r.a.createElement("td",{className:a},l.toLocaleDateString("en-gb",u)," ",l.toLocaleTimeString("en-gb",d)),r.a.createElement("td",{className:a},i.toLocaleDateString("en-gb",u)," ",i.toLocaleTimeString("en-gb",d)),r.a.createElement("td",{className:a},s.toFixed(3),"p"))}function p(e){var t=Object(n.useState)([]),a=Object(s.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)([]),i=Object(s.a)(l,2),m=i[0],d=i[1],g=Object(n.useState)([]),h=Object(s.a)(g,2),p=h[0],E=h[1];return Object(n.useEffect)((function(){u("GET","agileRates",(function(e,t){200===t?(c(e.rates),d(e.todaysMin),E(e.tmrsMin)):alert("There was an error");var a=document.getElementById("agile-rates-table-spinner");a&&(a.innerHTML="")}))}),[]),o.map((function(e,t){return r.a.createElement(f,{agileRate:e,todaysMin:m,tmrsMin:p,key:"".concat(t)})}))}function E(e){var t,a=e.controlState,n=e.operationState,o=e.boostState,c=e.cat;t=o||n?"danger":a?"warning":"success";var l,i="heating"===c?"Heating":"Water";l=o?"Boost\nOn":a?"hotWater"===c?"Scheduled\nControl":"Thermostat\nControl":"Control\nOff";return r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-block btn-".concat(t),style:{maxWidth:130,whiteSpace:"pre-wrap"},onClick:function(e){e.preventDefault(),e.target.blur();u("POST","currentStates/change",(function(e,t){201===t?u("GET","currentStates",v,{}):alert("State change failed")}),{device:c,state:!a})}},r.a.createElement("h4",{class:"font-weight-bold alert-heading text-center pt-1"},i),r.a.createElement("hr",{className:"alert-".concat(t)}),r.a.createElement("h6",{className:"text-center"},l),r.a.createElement("hr",{className:"alert-".concat(t)}),r.a.createElement(b,{state:n,type:0})))}function b(e){var t=e.state?"ON":"OFF",a=1===e.type?"h3":"h4";return r.a.createElement(a,{className:"font-weight-bold text-center"},t)}function v(e,t){!function(e){var t=e?"danger":"success";document.getElementById("boiler-operation-block").className="alert alert-".concat(t),c.a.render(r.a.createElement(b,{state:e,type:1}),document.getElementById("boiler-on-off-text"))}(e.operation[2]),c.a.render(r.a.createElement(E,{controlState:e.control.hotWater.state,operationState:e.operation[0],boostState:e.control.hotWater.boost,cat:"hotWater"}),document.getElementById("hotWater-states-block")),c.a.render(r.a.createElement(E,{controlState:e.control.heating.state,operationState:e.operation[1],boostState:!1,cat:"heating"}),document.getElementById("heating-states-block"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=document.getElementById("root");S&&c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(h,null)),S);var y=document.getElementById("boilerStateRows");y&&c.a.render(r.a.createElement(g,{limit:0}),y);var w=document.getElementById("boilerStateCard");w&&c.a.render(r.a.createElement(g,{limit:5}),w);var O=document.getElementById("agileRateTable");O&&c.a.render(r.a.createElement(p,null),O),document.getElementById("current-states-card-body")&&u("GET","currentStates",v,{}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[5,1,2]]]);
//# sourceMappingURL=main.a5c4c734.chunk.js.map